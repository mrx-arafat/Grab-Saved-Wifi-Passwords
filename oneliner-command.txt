powershell -Command "& {$Profiles = (netsh wlan show profiles | Select-String \"\:(.+)$\").Matches.Groups[1].Value.Trim() | Where-Object { $_ }; $results = foreach ($SSID in $Profiles) { $profileInfo = netsh wlan show profile name=`\"$SSID`\" key=clear; $keyContentLine = $profileInfo | Select-String \"Key Content\W+\:(.+)$\"; $password = if ($keyContentLine) {$keyContentLine.Matches.Groups[1].Value.Trim()} else {'No password set or network is open'}; [PSCustomObject]@{Wireless_Network_Name=$SSID; Password=$password}}; if ($results) { $results | Format-Table -AutoSize | Out-File -FilePath .\wifi_pass.txt -Encoding ASCII -Width 50 } else { Write-Output 'No wireless profiles with password found or accessible.' }}"
